---
import BaseLayout from "./BaseLayout.astro"
import type { Post } from "@afnizarnur/ui"
import PageHeader from "../components/PageHeader.astro"

export interface Props {
    post: Post
}

const { post } = Astro.props

const seoTitle = post.seo?.title || post.title
const seoDescription = post.seo?.description || post.excerpt
const ogImage = post.coverImage

const formattedDate = new Date(post.publishedAt).toLocaleDateString("en-US", {
    year: "numeric",
    month: "long",
    day: "numeric",
})

const actions = [
    {
        href: "/blog",
        label: "Back to blog",
        variant: "ghost" as const,
    },
]

const hasTags = post.tags && post.tags.length > 0
---

<BaseLayout
    title={seoTitle}
    description={seoDescription}
    ogImage={ogImage}
    type="article"
    publishedTime={post.publishedAt}
>
    <article class="page-shell page-shell--narrow">
        <!-- Post Header -->
        <PageHeader title={post.title} description={post.excerpt} actions={actions}>
            <time
                slot="eyebrow"
                class="text-sm font-semibold uppercase tracking-wide text-fgColor-tertiary"
                datetime={post.publishedAt}
            >
                {formattedDate}
            </time>

            {
                hasTags && (
                    <div slot="meta" class="flex flex-wrap gap-8">
                        {post.tags!.map((tag) => (
                            <span class="chip">{tag.title}</span>
                        ))}
                    </div>
                )
            }
        </PageHeader>

        {/* Cover Image */}
        {
            post.coverImage && (
                <figure class="mb-48">
                    <img
                        src={`${post.coverImage}?w=1200&auto=format`}
                        alt={post.coverImageAlt || post.title}
                        class="rounded-lg w-full"
                    />
                </figure>
            )
        }

        {/* Post Content */}
        <div class="prose prose-lg prose-neutral max-w-none">
            <slot />
        </div>
    </article>
</BaseLayout>
